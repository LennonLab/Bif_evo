---
title: "99. Non main figures"
output: word_document
date: "2023-12-10"
---


# Clear workspace and set directory
```{r setup}
knitr::opts_knit$set(root.dir=normalizePath("~/GitHub/Bifidobacterium"))
#setwd("~/GitHub/Bifidobacterium")
getwd()
rm(list=ls())
```

# Load packages and functions
```{r}
getwd()
require("ggplot2");require("tidyverse");require("png");require("dplyr");require("grid");require("vegan");require("indicspecies");require("ggrepel");require("gridExtra")
```

# Load data for breakout xpts
```{r}

mycols=c('black','black','black')
mycols_breakout=c('black','black','black','black','black','black','black','black')


mydf0<-read.csv("./Data/OD_20201104.csv")
mydf0$carbon2<-recode(mydf0$carbon2, "F" = "DP0", "G-F5" = "DP5", "G-F24" = "DP24")
mydf0$carbon2<-factor(mydf0$carbon2, levels=c("DP0","DP5","DP24"))
mydf0$carbon<-factor(mydf0$carbon, levels=c("Monomer","Low-DP","High-DP"))

#Import OD data from nutrient breakout xpt
mybreakout<-read.csv("./Data/breakout_20210512.csv")
mybreakout$carbon.tech<-factor(mybreakout$carbon.tech, levels=c("G", "F", "G:F 1:1","G-F","G:F 1:5", "G-F5","G:F 1:24","G-F24" ))

#Import OD Data from the nutrient breakout xpt, formatted as a 2way ANOVA: Factor 1: G-F ratio Factor 2: are the Gs and Fs monomers or bound up in oligomers?
mybreakout_2way<-read.csv("./Data/breakout_20210512_2way.csv")
mybreakout_2way$GF.ratio<-factor(mybreakout_2way$GF.ratio, levels=c("1:1","1:5","1:24"))
mybreakout_2way$Saccharide.size<-factor(mybreakout_2way$Saccharide.size, levels=c("Monomer","Oligomer"))

#######################Import OD data from nutrient breakout xpts with EVOLVED bacteria##############################
mybreakoutF<-read.csv("./Data/breakout_20210520_evolved_DP0.csv")
mybreakoutF$carbon.tech<-factor(mybreakoutF$carbon.tech, levels=c("G", "F", "G:F 1:1","G-F","G:F 1:5", "G-F5","G:F 1:24","G-F24" ))

mybreakoutP<-read.csv("./Data/breakout_20210526_evolved_DP5.csv")
mybreakoutP$carbon.tech<-factor(mybreakoutP$carbon.tech, levels=c("G", "F", "G:F 1:1","G-F","G:F 1:5", "G-F5","G:F 1:24","G-F24" ))

mybreakoutX<-read.csv("./Data/breakout_20210531_evolved_DP24.csv")
mybreakoutX$carbon.tech<-factor(mybreakoutX$carbon.tech, levels=c("G", "F", "G:F 1:1","G-F","G:F 1:5", "G-F5","G:F 1:24","G-F24" ))


```
# Load data for all other xpts; usually things will have been cut from their orig scripts and placed here, so may as well load all the data now
```{r}
###############Import basic OD data on the 3 substrates############
mydf0<-read_csv("./Data/OD_20201104.csv")
mydf0$carbon2<-recode(mydf0$carbon2, "F" = "DP0", "G-F5" = "DP5", "G-F24" = "DP24")
mydf0$carbon2<-factor(mydf0$carbon2, levels=c("DP0","DP5","DP24"))
mydf0$carbon<-factor(mydf0$carbon, levels=c("Monomer","Low-DP","High-DP"))

###########Import evolved data from timepoint T151, or 1003 generations of evolution.#############
mydf151<-read.csv("./Data/OD_evolved_20210509.csv")
mydf151$carbon<-factor(mydf151$carbon, levels=c("Monomer","Low-DP","High-DP"))
mydf151$carbon2<-recode(mydf151$carbon2, "F" = "DP0", "G-F5" = "DP5", "G-F24" = "DP24")
mydf151$carbon2<-factor(mydf151$carbon2, levels=c("DP0","DP5","DP24"))

#######################Import anaerobic growth curve data##############################################################
grcvdata<-read.csv("./Data/growth.curves.anaerobic.csv")
grcvdata$carbon.tech.assay<-factor(grcvdata$carbon.tech.assay, levels=c("F", "G-F5","G-F24","Ancestor"))
grcvdata$carbon.tech.evo<-factor(grcvdata$carbon.tech.evo, levels=c("F", "G-F5","G-F24","Ancestor"))
grcvdata$carbon.plotting.assay<-recode(grcvdata$carbon.tech.assay, "F" = "DP0", "G-F5" = "DP5", "G-F24" = "DP24")
grcvdata$carbon.plotting.evo<-recode(grcvdata$carbon.tech.evo, "F" = "DP0", "G-F5" = "DP5", "G-F24" = "DP24")

# Genomic analysis data
mutpopdf<- read.csv("~/GitHub/Bifidobacterium/Pipeline/2_Excel_/cases_signif.muts.per.pop.csv")
gxp.all.raw <- read.csv("~/GitHub/Bifidobacterium/Pipeline/3_Python/Outputs/Bifidobacterium_labels_gxp.csv")#<-- can do ordination analysis with ALL mutations in ALL genes
# <- read.csv("~/GitHub/Bifidobacterium/Pipeline/3_Python/Bifidobacterium_labels_gxp_fixed.only.csv")#<-- can do ordination with all FIXED mutations in ALL genes
gxp.signif.raw <- read.csv("~/GitHub/Bifidobacterium/Pipeline/3_Python/Outputs/Bifidobacterium_labels_gxp_signif.genes.only.csv")
gxp.signif.raw$sample <- as.factor(gxp.signif.raw$sample)
gxp.signif.raw$treatment <- as.factor(gxp.signif.raw$treatment)
levels(gxp.signif.raw$treatment)[levels(gxp.signif.raw$treatment)=="F"] <- "DP0"
levels(gxp.signif.raw$treatment)[levels(gxp.signif.raw$treatment)=="P"] <- "DP5"
levels(gxp.signif.raw$treatment)[levels(gxp.signif.raw$treatment)=="X"] <- "DP24"
gxp.signif <- as_tibble(gxp.signif.raw)
gxp.signif <- as.matrix(gxp.signif[,3:ncol(gxp.signif)])

gxp.all.raw$sample <- as.factor(gxp.all.raw$sample)
gxp.all.raw$treatment <- as.factor(gxp.all.raw$treatment)
levels(gxp.all.raw$treatment)[levels(gxp.all.raw$treatment)=="F"] <- "DP0"
levels(gxp.all.raw$treatment)[levels(gxp.all.raw$treatment)=="P"] <- "DP5"
levels(gxp.all.raw$treatment)[levels(gxp.all.raw$treatment)=="X"] <- "DP24"
gxp.all <- as_tibble(gxp.all.raw)
gxp.all <- as.matrix(gxp.all[,3:ncol(gxp.all)])


#Import data from HPLC experiments
myhplc<-read.csv("./Data/metabolite.flux.data.csv")
myhplc$condition_short<-factor(myhplc$condition_short,levels=c("GF","F"))
myhplc$evo_trt<-factor(myhplc$evo_trt,levels=c("F","P","X","Anc"))
myhplc$evo_trt_plotting<-recode(myhplc$evo_trt, "F" = "DP0", "P" = "DP5", "X" = "DP24", "Anc" = "Ancestor")
myhplc$evo_trt_plotting<-factor(myhplc$evo_trt_plotting,levels=c("DP0","DP5","DP24","Ancestor"))


```

# ########################################### BREAKOUT SECTION


# Do statistical tests for breakout xpt
```{r}
##########################Nutrient breakout experiment#################################


####Within evolution treatments (i.e., anc, F evolved, P evolved, X evolved), assess whether growth is different on the 8 different nutrient compositions.

breakoutaov<-aov(mybreakout$OD.600 ~ mybreakout$carbon.tech)
summary(breakoutaov)
TukeyHSD(breakoutaov)


#breakout2way<-aov(mybreakout_2way$OD.600 ~ mybreakout_2way$Saccharide.size + mybreakout_2way$GF.ratio + mybreakout_2way$Saccharide.size*mybreakout_2way$GF.ratio)
#summary(breakout2way)
#TukeyHSD(breakout2way)


##It looks like both the G:F ratio and the molecule size "matter"
#But we can quantify this with multiple regression

#breakoutmodel<-lm(formula = mybreakout$OD.600 ~ mybreakout$molecule.size + mybreakout$proportion.F + mybreakout$molecule.size*mybreakout$proportion.F)
breakoutmodel<-lm(formula = mybreakout$OD.600 ~ mybreakout$molecule.size + mybreakout$proportion.F)
summary(breakoutmodel)


breakoutaovF<-aov(mybreakoutF$OD.600 ~ mybreakoutF$carbon.tech)
summary(breakoutaovF)
TukeyHSD(breakoutaovF)

breakoutaovP<-aov(mybreakoutP$OD.600 ~ mybreakoutP$carbon.tech)
summary(breakoutaovP)
TukeyHSD(breakoutaovP)

breakoutaovX<-aov(mybreakoutX$OD.600 ~ mybreakoutX$carbon.tech)
summary(breakoutaovX)
TukeyHSD(breakoutaovX)

mymonomers<-filter(mybreakout,molecule.size==1)
mymonomersF<-filter(mybreakoutF,molecule.size==1)
mymonomersP<-filter(mybreakoutP,molecule.size==1)
mymonomersX<-filter(mybreakoutX,molecule.size==1)

monomersaov<-aov(mymonomers$OD.600 ~ mymonomers$carbon.tech)
summary(monomersaov)
TukeyHSD(monomersaov)

monomersaovF<-aov(mymonomersF$OD.600 ~ mymonomersF$carbon.tech)
summary(monomersaovF)
TukeyHSD(monomersaovF)

monomersaovP<-aov(mymonomersP$OD.600 ~ mymonomersP$carbon.tech)
summary(monomersaovP)
TukeyHSD(monomersaovP)

monomersaovX<-aov(mymonomersX$OD.600 ~ mymonomersX$carbon.tech)
summary(monomersaovX)
TukeyHSD(monomersaovX)

##It looks like both the G:F ratio and the molecule size "matter"
#But we can quantify this with multiple regression
breakoutmodelF<-lm(formula = mybreakoutF$OD.600 ~ mybreakoutF$molecule.size + mybreakoutF$proportion.F + mybreakoutF$molecule.size*mybreakoutF$proportion.F)
summary(breakoutmodelF)

breakoutmodelP<-lm(formula = mybreakoutP$OD.600 ~ mybreakoutP$molecule.size + mybreakoutP$proportion.F)
summary(breakoutmodelP)

breakoutmodelX<-lm(formula = mybreakoutX$OD.600 ~ mybreakoutX$molecule.size + mybreakoutX$proportion.F)
summary(breakoutmodelX)

monomermodel<-lm(formula = mymonomers$OD.600 ~ mymonomers$proportion.F)
summary(monomermodel)

monomermodelF<-lm(formula = mymonomersF$OD.600 ~ mymonomersF$proportion.F)
summary(monomermodelF)

monomermodelP<-lm(formula = mymonomersP$OD.600 ~ mymonomersP$proportion.F)
summary(monomermodelP)

monomermodelX<-lm(formula = mymonomersX$OD.600 ~ mymonomersX$proportion.F)
summary(monomermodelX)

mymonomervector<-c(mean(filter(mymonomers,carbon.tech=="F")$OD.600),mean(filter(mymonomers,carbon.tech=="G:F 1:24")$OD.600),mean(filter(mymonomers,carbon.tech=="G:F 1:5")$OD.600),mean(filter(mymonomers,carbon.tech=="G:F 1:1")$OD.600),mean(filter(mymonomers,carbon.tech=="G")$OD.600))

mymonomervectorF<-c(mean(filter(mymonomersF,carbon.tech=="F")$OD.600),mean(filter(mymonomersF,carbon.tech=="G:F 1:24")$OD.600),mean(filter(mymonomersF,carbon.tech=="G:F 1:5")$OD.600),mean(filter(mymonomersF,carbon.tech=="G:F 1:1")$OD.600),mean(filter(mymonomersF,carbon.tech=="G")$OD.600))

mymonomervectorP<-c(mean(filter(mymonomersP,carbon.tech=="F")$OD.600),mean(filter(mymonomersP,carbon.tech=="G:F 1:24")$OD.600),mean(filter(mymonomersP,carbon.tech=="G:F 1:5")$OD.600),mean(filter(mymonomersP,carbon.tech=="G:F 1:1")$OD.600),mean(filter(mymonomersP,carbon.tech=="G")$OD.600))

mymonomervectorX<-c(mean(filter(mymonomersX,carbon.tech=="F")$OD.600),mean(filter(mymonomersX,carbon.tech=="G:F 1:24")$OD.600),mean(filter(mymonomersX,carbon.tech=="G:F 1:5")$OD.600),mean(filter(mymonomersX,carbon.tech=="G:F 1:1")$OD.600),mean(filter(mymonomersX,carbon.tech=="G")$OD.600))

mymonomerFprops<-c(1,24/25,5/6,1/2,0)

monomervectormodel<-lm(formula = mymonomervector ~ mymonomerFprops)
summary(monomervectormodel)

monomervectormodelF<-lm(formula = mymonomervectorF ~ mymonomerFprops)
summary(monomervectormodelF)

monomervectormodelP<-lm(formula = mymonomervectorP ~ mymonomerFprops)
summary(monomervectormodelP)

monomervectormodelX<-lm(formula = mymonomervectorX ~ mymonomerFprops)
summary(monomervectormodelX)


#1
#Did F-evolved bacteria have higher growth on DP5 than the ancestor?
t1bmu<-mean(filter(mybreakout, carbon.tech == "G-F5")$OD.600)
t.test(c(filter(mybreakoutF, carbon.tech=="G-F5")$OD.600),mu=t1bmu,alternative = 'g')
t1bp<-t.test(c(filter(mybreakoutF, carbon.tech=="G-F5")$OD.600),mu=t1bmu,alternative = 'g')$p.value

#2
#Did F-evolved bacteria have higher growth on DP24 than the ancestor?
t2bmu<-mean(filter(mybreakout, carbon.tech == "G-F24")$OD.600)
t.test(filter(mybreakoutF, carbon.tech=="G-F24")$OD.600,mu=t2bmu,alternative = 'g')
t2bp<-t.test(filter(mybreakoutF, carbon.tech=="G-F24")$OD.600,mu=t2bmu,alternative = 'g')$p.value

#For the F-evolved, I need to correct for multiple testing.
bFpvec<-c(t1bp,t2bp)
bFpvec.adjust<-p.adjust(p=bFpvec, method = "BH")#cite BH&Y 2009
bFpvec.adjust
#FDR: 0.0362450269 0.0003116769



#3, #4, #5
#I need to test whether DP5 and DP24 evolved populations increased growth on fructose. Also, was DP24 growth significantly more than DP5 growth?
#3: DP5 vs. ancestor, growth on F
t3bmu<-mean(filter(mybreakout, carbon.tech == "F")$OD.600)
t.test(x=c(filter(mybreakoutP, carbon.tech=="F")$OD.600),mu=t3bmu,alternative = 'g')
t3bp<-t.test(x=c(filter(mybreakoutP, carbon.tech=="F")$OD.600),mu=t3bmu,alternative = 'g')$p.value

#4: DP24 vs. ancor, growth on F
t4bmu<-mean(filter(mybreakout, carbon.tech == "F")$OD.600)
t.test(filter(mybreakoutX, carbon.tech=="F")$OD.600,mu=t4bmu,alternative = 'g')
t4bp<-t.test(filter(mybreakoutX, carbon.tech=="F")$OD.600,mu=t4bmu,alternative = 'g')$p.value

#5: Is there a difference between DP5 grwth and DP24 grwth on Fructose?
var.test(x=c(filter(mybreakoutP, carbon.tech=="F")$OD.600),y=c(filter(mybreakoutX, carbon.tech=="F")$OD.600),ratoi=1,alternative = 't')
#P = .02853. Heteroscedastic.
t.test(x=c(filter(mybreakoutP, carbon.tech=="F")$OD.600),y=c(filter(mybreakoutX, carbon.tech=="F")$OD.600),mu=0,alternative='t',paired=F,var.equal = F)
t5bp<-t.test(x=c(filter(mybreakoutP, carbon.tech=="F")$OD.600),y=c(filter(mybreakoutX, carbon.tech=="F")$OD.600),mu=0,alternative='t',paired=F,var.equal = F)$p.value


#Regarding test #5: 	Finally, do a t-test: was growth higher for DP24 on F than DP5 on F? And what would that suggest??? Well, it supports the breakout idea that it's import that is key, rather than monomer metabolism. If G-F24 has higher growth on fructose, it could be because G-F24 populations are evolving to import degraded inulin dregs, while DP5 populations are evolution to import actual DP = 5 FOSs. But, it was only marginally signif at P = 0.0856

binulinpvec<-c(t3bp,t4bp,t5bp)
binulinpvec.adjust<-p.adjust(p=binulinpvec, method = "BH")#cite BH&Y 2009
binulinpvec.adjust
#FDR: 8.878737e-05 7.849274e-08 8.557475e-02
```



# Make plots for breakout xpt
```{r}
#Ancestor plot
odbreakout <- ggplot(mybreakout, aes(x=carbon.tech, y=OD.600))
odbreakout + geom_jitter(
  aes(shape = carbon.tech, color = carbon.tech), #I cut out the "shape = Evolution, " part of the aes so that all shapes would be the same shape
  position = position_jitterdodge(jitter.width = 1.5, dodge.width = 0.7),
  size = 5.5, stroke = 2) +
  scale_shape_manual(values = c(0,0,0,0,0,0,0,0)) +#12 is a square with a vertical cross inside it
  stat_summary(
    aes(color = carbon.tech),
    fun.data = "mean_se", fun.args = list(mult = (1)), #mean_sdl add +/- standard deviation; mult=1 means that it is SD*1 that is drawn.  Mean_se draws the standard error of the mean
    geom = "pointrange", size = 3, stroke=2, shape=16,
    position = position_dodge(1),
  ) +
  scale_color_manual(values = mycols_breakout) +
  scale_y_continuous(limits = c(-0.04,1.6),breaks=c(0,.5,1,1.5), expand = c(0,0)) +
  labs(x="\nCarbon source",y="OD 600\n") +
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.background = element_blank(), axis.line = element_line(colour = "black")) +
    theme(legend.key=element_blank(),axis.text.x=element_text(size=34,margin = margin(t = 20, r = 0, b = 0, l = 0)),axis.text.y=element_text(size=34,margin = margin(t = 0, r = 20, b = 0, l = 0)),axis.title=element_text(size=36),legend.text=element_text(size=22),legend.title = element_text(size=34), axis.ticks.y = element_line(color = "black", size = 3), axis.ticks.x = element_line(color = "black", size = 3), axis.ticks.length.x=unit(0.7, "cm"),axis.ticks.length.y=unit(0.7, "cm"), legend.position = "none", panel.border = element_rect(color = "black", fill = NA, size = 3.5), axis.line = element_line(colour = "black"))


anc.breakout.colors<-c("darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey")

odbreakoutF <- ggplot(mybreakoutF, aes(x=carbon.tech, y=OD.600))
odbreakoutF + geom_jitter(
  aes(shape = carbon.tech, color = carbon.tech), #I cut out the "shape = Evolution, " part of the aes so that all shapes would be the same shape
  position = position_jitterdodge(jitter.width = 1.5, dodge.width = 0.7),
  size = 5.5, stroke = 2) +
  #geom_errorbar(aes(ymax=anc.breakout.vector,ymin=anc.breakout.vector),color=anc.breakout.colors,lwd = 2.2,linetype=117) + 
  #geom_errorbar(data=mybreakoutF, mapping = aes(x=carbon.tech,ymin=anc.value,ymax=anc.value),color=anc.breakout.colors,lwd=2.2,linetype=117) +
  geom_errorbar(data=mybreakoutF, mapping = aes(x=carbon.tech,ymin=anc.value,ymax=anc.value),color=anc.breakout.colors,lwd=2.2,linetype=117) +
  scale_shape_manual(values = c(0,0,0,0,0,0,0,0)) +#12 is a square with a vertical cross inside it
  stat_summary(
    aes(color = carbon.tech),
    fun.data = "mean_se", fun.args = list(mult = (1)), #mean_sdl add +/- standard deviation; mult=1 means that it is SD*1 that is drawn.  Mean_se draws the standard error of the mean
    geom = "pointrange", size = 3, stroke=2, shape=16,
    position = position_dodge(1),
  ) +
  scale_color_manual(values = mycols_breakout) +
  scale_y_continuous(limits = c(-0.04,1.83),breaks=c(0,.5,1,1.5), expand = c(0,0)) +
  labs(x="\nCarbon source",y="OD 600\n") +
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.background = element_blank(), axis.line = element_line(colour = "black")) +
    theme(legend.key=element_blank(),axis.text.x=element_text(size=34,margin = margin(t = 20, r = 0, b = 0, l = 0)),axis.text.y=element_text(size=34,margin = margin(t = 0, r = 20, b = 0, l = 0)),axis.title=element_text(size=36),legend.text=element_text(size=22),legend.title = element_text(size=34), axis.ticks.y = element_line(color = "black", size = 3), axis.ticks.x = element_line(color = "black", size = 3), axis.ticks.length.x=unit(0.7, "cm"),axis.ticks.length.y=unit(0.7, "cm"), legend.position = "none", panel.border = element_rect(color = "black", fill = NA, size = 3.5), axis.line = element_line(colour = "black"))

odbreakoutP <- ggplot(mybreakoutP, aes(x=carbon.tech, y=OD.600))
odbreakoutP + geom_jitter(
  aes(shape = carbon.tech, color = carbon.tech), #I cut out the "shape = Evolution, " part of the aes so that all shapes would be the same shape
  position = position_jitterdodge(jitter.width = 1.5, dodge.width = 0.7),
  size = 5.5, stroke = 2) +
  geom_errorbar(data=mybreakoutP, mapping = aes(x=carbon.tech,ymin=anc.value,ymax=anc.value),color=anc.breakout.colors,lwd=2.2,linetype=117) +
  scale_shape_manual(values = c(0,0,0,0,0,0,0,0)) +#12 is a square with a vertical cross inside it
  stat_summary(
    aes(color = carbon.tech),
    fun.data = "mean_se", fun.args = list(mult = (1)), #mean_sdl add +/- standard deviation; mult=1 means that it is SD*1 that is drawn.  Mean_se draws the standard error of the mean
    geom = "pointrange", size = 3, stroke=2, shape=16,
    position = position_dodge(1),
  ) +
  scale_color_manual(values = mycols_breakout) +
  scale_y_continuous(limits = c(-0.04,1.83),breaks=c(0,.5,1,1.5), expand = c(0,0)) +
  labs(x="\nCarbon source",y="OD 600\n") +
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.background = element_blank(), axis.line = element_line(colour = "black")) +
    theme(legend.key=element_blank(),axis.text.x=element_text(size=34,margin = margin(t = 20, r = 0, b = 0, l = 0)),axis.text.y=element_text(size=34,margin = margin(t = 0, r = 20, b = 0, l = 0)),axis.title=element_text(size=36),legend.text=element_text(size=22),legend.title = element_text(size=34), axis.ticks.y = element_line(color = "black", size = 3), axis.ticks.x = element_line(color = "black", size = 3), axis.ticks.length.x=unit(0.7, "cm"),axis.ticks.length.y=unit(0.7, "cm"), legend.position = "none", panel.border = element_rect(color = "black", fill = NA, size = 3.5), axis.line = element_line(colour = "black"))

odbreakoutX <- ggplot(mybreakoutX, aes(x=carbon.tech, y=OD.600))
odbreakoutX + geom_jitter(
  aes(shape = carbon.tech, color = carbon.tech), #I cut out the "shape = Evolution, " part of the aes so that all shapes would be the same shape
  position = position_jitterdodge(jitter.width = 1.5, dodge.width = 0.7),
  size = 5.5, stroke = 2) +
  geom_errorbar(data=mybreakoutX, mapping = aes(x=carbon.tech,ymin=anc.value,ymax=anc.value),color=anc.breakout.colors,lwd=2.2,linetype=117) +
  scale_shape_manual(values = c(0,0,0,0,0,0,0,0)) +#12 is a square with a vertical cross inside it
  stat_summary(
    aes(color = carbon.tech),
    fun.data = "mean_se", fun.args = list(mult = (1)), #mean_sdl add +/- standard deviation; mult=1 means that it is SD*1 that is drawn.  Mean_se draws the standard error of the mean
    geom = "pointrange", size = 3, stroke=2, shape=16,
    position = position_dodge(1),
  ) +
  scale_color_manual(values = mycols_breakout) +
  scale_y_continuous(limits = c(-0.04,1.83),breaks=c(0,.5,1,1.5), expand = c(0,0)) +
  labs(x="\nCarbon source",y="OD 600\n") +
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.background = element_blank(), axis.line = element_line(colour = "black")) +
    theme(legend.key=element_blank(),axis.text.x=element_text(size=34,margin = margin(t = 20, r = 0, b = 0, l = 0)),axis.text.y=element_text(size=34,margin = margin(t = 0, r = 20, b = 0, l = 0)),axis.title=element_text(size=36),legend.text=element_text(size=22),legend.title = element_text(size=34), axis.ticks.y = element_line(color = "black", size = 3), axis.ticks.x = element_line(color = "black", size = 3), axis.ticks.length.x=unit(0.7, "cm"),axis.ticks.length.y=unit(0.7, "cm"), legend.position = "none", panel.border = element_rect(color = "black", fill = NA, size = 3.5), axis.line = element_line(colour = "black"))
```

#Breakout plots with sucrose and G:F 1:1 removed for the purpose of simplifying the figure.
```{r}
#####################################################################################################################################################################################################

breakout_nosucrose<-filter(mybreakout,carbon.tech != "G-F" & carbon.tech != "G:F 1:1")
breakoutF_nosucrose<-filter(mybreakoutF,carbon.tech != "G-F" & carbon.tech != "G:F 1:1")
breakoutP_nosucrose<-filter(mybreakoutP,carbon.tech != "G-F" & carbon.tech != "G:F 1:1")
breakoutX_nosucrose<-filter(mybreakoutX,carbon.tech != "G-F" & carbon.tech != "G:F 1:1")


bleg<-readPNG("~/GitHub/Bifidobacterium/Figures/20211103_185311.PNG")
breakoutlegend<-rasterGrob(bleg, interpolate = TRUE)


#Ancestor plot, Fig 2.5. Needs to be converted to 2-panel figure
odbreakout_nosucrose <- ggplot(breakout_nosucrose, aes(x=carbon.tech, y=OD.600))
odbreakout_nosucrose + geom_jitter(
  aes(shape = carbon.tech, color = carbon.tech), #I cut out the "shape = Evolution, " part of the aes so that all shapes would be the same shape
  position = position_jitterdodge(jitter.width = 2.5, dodge.width = 0.7),
  size = 5.5, stroke = 2) +
  scale_shape_manual(values = c(0,0,0,15,0,15)) +#12 is a square with a vertical cross inside it
  #scale_color_manual(values = c("black","black","black","blue","black","blue")) +
  stat_summary(
    aes(color = carbon.tech),
    fun.data = "mean_se", fun.args = list(mult = (1)), #mean_sdl add +/- standard deviation; mult=1 means that it is SD*1 that is drawn.  Mean_se draws the standard error of the mean
    geom = "pointrange", size = 3, stroke=2, shape=16,
    position = position_dodge(1),
  ) +
  scale_color_manual(values = mycols_breakout) +
  scale_y_continuous(limits = c(-0.04,1.6),breaks=c(0,.5,1,1.5), expand = c(0,0)) +
  scale_x_discrete(labels = c("G"="G","F"="F","G:F 1:5"="1:5","G-F5"="1:5","G:F 1:24"="1:24","G-F24"="1:24"))+
  labs(x="\nG:F ratio",y="Biomass (OD600)\n") +
  annotate("text",x=0.68,y=1.5,label="A",size=12,color="black")+
  annotate("text",x=1.7,y=0.55,label="D",size=12,color="black")+
  annotate("text",x=2.7,y=1.33,label="B",size=12,color="black")+
  annotate("text",x=3.7,y=1.07,label="C",size=12,color="black")+
  annotate("text",x=4.7,y=1.07,label="C",size=12,color="black")+
  annotate("text",x=5.65,y=0.4,label="E",size=12,color="black")+
  annotation_custom(grob = breakoutlegend, xmin=5.4, xmax=6.4, ymin=1.4, ymax=1.55)+
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.background = element_blank(), axis.line = element_line(colour = "black")) +
    theme(legend.key=element_blank(),axis.text.x=element_text(size=34,margin = margin(t = 20, r = 0, b = 0, l = 0)),axis.text.y=element_text(size=34,margin = margin(t = 0, r = 20, b = 0, l = 0)),axis.title=element_text(size=36),legend.text=element_text(size=22),legend.title = element_text(size=34), axis.ticks.y = element_line(color = "black", size = 3), axis.ticks.x = element_line(color = "black", size = 3), axis.ticks.length.x=unit(0.7, "cm"),axis.ticks.length.y=unit(0.7, "cm"), legend.position = "none", panel.border = element_rect(color = "black", fill = NA, size = 3.5), axis.line = element_line(colour = "black"))



#bp1draw <- ggdraw() +
#draw_image(bleg, x=1, y=1, scale=1)+
#  draw_plot(bp1)
#insert_element(p=breakoutlegend, left=0.5,right=1.5,top=0.9,bottom=0.5)


anc.breakout.colors_nosucrose<-c("darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey")

odbreakoutF_nosucrose <- ggplot(breakoutF_nosucrose, aes(x=carbon.tech, y=OD.600))
odbreakoutF_nosucrose + geom_jitter(
  aes(shape = carbon.tech, color = carbon.tech), #I cut out the "shape = Evolution, " part of the aes so that all shapes would be the same shape
  position = position_jitterdodge(jitter.width = 1.5, dodge.width = 0.7),
  size = 5.5, stroke = 2) +
  #geom_errorbar(aes(ymax=anc.breakout.vector,ymin=anc.breakout.vector),color=anc.breakout.colors,lwd = 2.2,linetype=117) + 
  #geom_errorbar(data=breakoutF_nosucrose, mapping = aes(x=carbon.tech,ymin=anc.value,ymax=anc.value),color=anc.breakout.colors,lwd=2.2,linetype=117) +
  geom_errorbar(data=breakoutF_nosucrose, mapping = aes(x=carbon.tech,ymin=anc.value,ymax=anc.value),color=anc.breakout.colors_nosucrose,lwd=2.2,linetype=117) +
  scale_shape_manual(values = c(0,0,0,15,0,15)) +#12 is a square with a vertical cross inside it
  stat_summary(
    aes(color = carbon.tech),
    fun.data = "mean_se", fun.args = list(mult = (1)), #mean_sdl add +/- standard deviation; mult=1 means that it is SD*1 that is drawn.  Mean_se draws the standard error of the mean
    geom = "pointrange", size = 3, stroke=2, shape=16,
    position = position_dodge(1),
  ) +
  scale_color_manual(values = mycols_breakout) +
  scale_y_continuous(limits = c(-0.04,1.83),breaks=c(0,.5,1,1.5), expand = c(0,0)) +
  scale_x_discrete(labels = c("G"="G","F"="F","G:F 1:5"="1:5","G-F5"="1:5","G:F 1:24"="1:24","G-F24"="1:24"))+
  labs(x="\nG:F ratio",y="Biomass (OD 600)\n") +
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.background = element_blank(), axis.line = element_line(colour = "black")) +
    theme(legend.key=element_blank(),axis.text.x=element_text(size=34,margin = margin(t = 20, r = 0, b = 0, l = 0)),axis.text.y=element_text(size=34,margin = margin(t = 0, r = 20, b = 0, l = 0)),axis.title=element_text(size=36),legend.text=element_text(size=22),legend.title = element_text(size=34), axis.ticks.y = element_line(color = "black", size = 3), axis.ticks.x = element_line(color = "black", size = 3), axis.ticks.length.x=unit(0.7, "cm"),axis.ticks.length.y=unit(0.7, "cm"), legend.position = "none", panel.border = element_rect(color = "black", fill = NA, size = 3.5), axis.line = element_line(colour = "black"))

odbreakoutP_nosucrose <- ggplot(breakoutP_nosucrose, aes(x=carbon.tech, y=OD.600))
odbreakoutP_nosucrose + geom_jitter(
  aes(shape = carbon.tech, color = carbon.tech), #I cut out the "shape = Evolution, " part of the aes so that all shapes would be the same shape
  position = position_jitterdodge(jitter.width = 1.5, dodge.width = 0.7),
  size = 5.5, stroke = 2) +
  geom_errorbar(data=breakoutP_nosucrose, mapping = aes(x=carbon.tech,ymin=anc.value,ymax=anc.value),color=anc.breakout.colors_nosucrose,lwd=2.2,linetype=117) +
  scale_shape_manual(values = c(0,0,0,15,0,15)) +#12 is a square with a vertical cross inside it
  stat_summary(
    aes(color = carbon.tech),
    fun.data = "mean_se", fun.args = list(mult = (1)), #mean_sdl add +/- standard deviation; mult=1 means that it is SD*1 that is drawn.  Mean_se draws the standard error of the mean
    geom = "pointrange", size = 3, stroke=2, shape=16,
    position = position_dodge(1),
  ) +
  scale_color_manual(values = mycols_breakout) +
  scale_y_continuous(limits = c(-0.04,1.83),breaks=c(0,.5,1,1.5), expand = c(0,0)) +
  scale_x_discrete(labels = c("G"="G","F"="F","G:F 1:5"="1:5","G-F5"="1:5","G:F 1:24"="1:24","G-F24"="1:24"))+
  labs(x="\nG:F ratio",y="Biomass (OD 600)\n") +
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.background = element_blank(), axis.line = element_line(colour = "black")) +
    theme(legend.key=element_blank(),axis.text.x=element_text(size=34,margin = margin(t = 20, r = 0, b = 0, l = 0)),axis.text.y=element_text(size=34,margin = margin(t = 0, r = 20, b = 0, l = 0)),axis.title=element_text(size=36),legend.text=element_text(size=22),legend.title = element_text(size=34), axis.ticks.y = element_line(color = "black", size = 3), axis.ticks.x = element_line(color = "black", size = 3), axis.ticks.length.x=unit(0.7, "cm"),axis.ticks.length.y=unit(0.7, "cm"), legend.position = "none", panel.border = element_rect(color = "black", fill = NA, size = 3.5), axis.line = element_line(colour = "black"))

odbreakoutX_nosucrose <- ggplot(breakoutX_nosucrose, aes(x=carbon.tech, y=OD.600))
odbreakoutX_nosucrose + geom_jitter(
  aes(shape = carbon.tech, color = carbon.tech), #I cut out the "shape = Evolution, " part of the aes so that all shapes would be the same shape
  position = position_jitterdodge(jitter.width = 1.5, dodge.width = 0.7),
  size = 5.5, stroke = 2) +
  geom_errorbar(data=breakoutX_nosucrose, mapping = aes(x=carbon.tech,ymin=anc.value,ymax=anc.value),color=anc.breakout.colors_nosucrose,lwd=2.2,linetype=117) +
  scale_shape_manual(values = c(0,0,0,15,0,15)) +#12 is a square with a vertical cross inside it
  stat_summary(
    aes(color = carbon.tech),
    fun.data = "mean_se", fun.args = list(mult = (1)), #mean_sdl add +/- standard deviation; mult=1 means that it is SD*1 that is drawn.  Mean_se draws the standard error of the mean
    geom = "pointrange", size = 3, stroke=2, shape=16,
    position = position_dodge(1),
  ) +
  scale_color_manual(values = mycols_breakout) +
  scale_y_continuous(limits = c(-0.04,1.83),breaks=c(0,.5,1,1.5), expand = c(0,0)) +
  scale_x_discrete(labels = c("G"="G","F"="F","G:F 1:5"="1:5","G-F5"="1:5","G:F 1:24"="1:24","G-F24"="1:24"))+
  labs(x="\nG:F ratio",y="Biomass (OD 600)\n") +
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.background = element_blank(), axis.line = element_line(colour = "black")) +
    theme(legend.key=element_blank(),axis.text.x=element_text(size=34,margin = margin(t = 20, r = 0, b = 0, l = 0)),axis.text.y=element_text(size=34,margin = margin(t = 0, r = 20, b = 0, l = 0)),axis.title=element_text(size=36),legend.text=element_text(size=22),legend.title = element_text(size=34), axis.ticks.y = element_line(color = "black", size = 3), axis.ticks.x = element_line(color = "black", size = 3), axis.ticks.length.x=unit(0.7, "cm"),axis.ticks.length.y=unit(0.7, "cm"), legend.position = "none", panel.border = element_rect(color = "black", fill = NA, size = 3.5), axis.line = element_line(colour = "black"))

```






# Make unused figures from the PhD dissertation (breakout)
```{r}
##Ancestor plot with 2 way ANOVA framework
breakout.2way.colors<-c("darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey")

dummy.1<-mean(c(filter(mybreakout_2way, GF.ratio=="1:1", Saccharide.size=="Monosaccharide")$OD.600))
dummy.2<-mean(c(filter(mybreakout_2way, GF.ratio=="1:5", Saccharide.size=="Monosaccharide")$OD.600))
dummy.3<-mean(c(filter(mybreakout_2way, GF.ratio=="1:24", Saccharide.size=="Monosaccharide")$OD.600))
dummy.4<-mean(c(filter(mybreakout_2way, GF.ratio=="1:1", Saccharide.size=="Oligosaccharide")$OD.600))
dummy.5<-mean(c(filter(mybreakout_2way, GF.ratio=="1:5", Saccharide.size=="Oligosaccharide")$OD.600))
dummy.6<-mean(c(filter(mybreakout_2way, GF.ratio=="1:24", Saccharide.size=="Oligosaccharide")$OD.600))

anc.means.OD<-c(dummy.2,dummy.2,dummy.2,dummy.2,dummy.2,dummy.2,dummy.2,dummy.2,dummy.3,dummy.3,dummy.3,dummy.3,dummy.3,dummy.3,dummy.3,dummy.3,dummy.1,dummy.1,dummy.1,dummy.1,dummy.1,dummy.1,dummy.1,dummy.1,dummy.4,dummy.4,dummy.4,dummy.4,dummy.4,dummy.4,dummy.4,dummy.4,dummy.5,dummy.5,dummy.5,dummy.5,dummy.5,dummy.5,dummy.5,dummy.5,dummy.6,dummy.6,dummy.6,dummy.6,dummy.6,dummy.6,dummy.6,dummy.6)

###I don't understand the order in which it plots the error bars. For some reason it goes 3-->1-->2-->4-->5-->6 
###To fix the order, you have to put the values into your original spreadsheet

enaught <- ggplot(mybreakout_2way, aes(x=GF.ratio, y=OD.600))
enaught +
  #geom_errorbar(aes(ymax=anc.means.OD,ymin=anc.means.OD),color=breakout.2way.colors,lwd = 2.2,linetype=117) +
  geom_jitter(aes(shape = Saccharide.size, color = Saccharide.size),
              position = position_jitterdodge(jitter.width = 0.4, dodge.width = 0.35),
              size = 9.5, stroke = 1.8
  ) +
  stat_summary(
    aes(color = Saccharide.size),
    fun.data = "mean_se", fun.args = list(mult = (1)), #mean_sdl add +/- standard deviation; mult=1 means that it is SD*1 that is drawn.  Mean_se draws the standard error of the mean
    geom = "pointrange", size = 1.8, shape=95, stroke=2,
    position = position_dodge(0.35),
    show.legend=FALSE
  ) +
  scale_color_manual(values = c("black","black"), labels = c("Monomer","Oligomer")) +
  scale_shape_manual(values = c(0,15), labels = c("Monomer", "Oligomer")) +#12 is a square with a vertical cross inside it
  labs(x="\nG:F ratio",y="OD 600") +
  scale_y_continuous(limits = c(-0.04,1.64),breaks=c(0,.5,1,1.5), expand = c(0,0)) +
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.background = element_blank(),panel.border = element_rect(color = "black", fill = NA, size = 3.5), axis.line = element_line(colour = "black")) +
  theme(legend.key=element_blank(),legend.key.size = unit(2, "lines"),axis.text=element_text(size=34),axis.title=element_text(size=36),legend.text=element_text(size=42),legend.title = element_text(size=34), axis.line.x.bottom = element_blank(), axis.line.y.left = element_blank(), axis.ticks.y = element_line(color = "black", size = 3.5), axis.ticks.length = unit(.3, "cm"), axis.ticks.x = element_blank())




#####Fig. 2.5
#Now make fig. 2.5, with 2 panels
fig2.5a_breakout<-filter(mybreakout,carbon.tech=="G" | carbon.tech=="F")
fig2.5a_plot <- ggplot(fig2.5a_breakout, aes(x=carbon.tech, y=OD.600))
fig2.5apanel <- fig2.5a_plot + geom_jitter(
  aes(shape = carbon.tech, color = carbon.tech), #I cut out the "shape = Evolution, " part of the aes so that all shapes would be the same shape
  position = position_jitterdodge(jitter.width = 1.5, dodge.width = 0.7),
  size = 5.5, stroke = 2) +
  scale_shape_manual(values = c(0,0)) +#12 is a square with a vertical cross inside it
  #scale_color_manual(values = c("black","black","black","blue","black","blue")) +
  stat_summary(
    aes(color = carbon.tech),
    fun.data = "mean_se", fun.args = list(mult = (1)), #mean_sdl add +/- standard deviation; mult=1 means that it is SD*1 that is drawn.  Mean_se draws the standard error of the mean
    geom = "pointrange", size = 3, stroke=2, shape=16,
    position = position_dodge(1),
  ) +
  scale_color_manual(values = mycols_breakout) +
  scale_y_continuous(limits = c(-0.04,1.7),breaks=c(.5,1,1.5), expand = c(0,0)) +
  annotate("text",x=0.5,y=1.65,label="a",size=12,color="black")+
  scale_x_discrete(labels = c("G"="Glucose","F"="Fructose"))+
  labs(x="",y="Biomass (OD600)\n") +
  annotate("text",x=0.75,y=1.5,label="A",size=12,color="black")+
  annotate("text",x=1.75,y=0.55,label="B",size=12,color="black")+
  #annotation_custom(grob = breakoutlegend, xmin=2., xmax=2.5, ymin=1.45, ymax=1.55)+
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.background = element_blank(), axis.line = element_line(colour = "black")) +
  theme(legend.key=element_blank(),axis.text.x=element_text(size=34,margin = margin(t = 20, r = 0, b = 0, l = 0)),axis.text.y=element_text(size=34,margin = margin(t = 0, r = 20, b = 0, l = 0)),axis.title=element_text(size=36),legend.text=element_text(size=22),legend.title = element_text(size=34), axis.ticks.y = element_line(color = "black", size = 3), axis.ticks.x = element_line(color = "black", size = 3), axis.ticks.length.x=unit(0.7, "cm"),axis.ticks.length.y=unit(0.7, "cm"), legend.position = "none", panel.border = element_rect(color = "black", fill = NA, size = 3.5), axis.line = element_line(colour = "black"))
fig2.5apanel

fig2.5bbreakout<-filter(mybreakout,carbon.tech == "G-F5" | carbon.tech == "G:F 1:5" | carbon.tech == "G-F24" | carbon.tech == "G:F 1:24")
fig2.5bcolors<-c("darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey")
#F plot
fig2.5bplot <- ggplot(fig2.5bbreakout, aes(x=carbon.tech, y=OD.600))
fig2.5bpanel<-fig2.5bplot + geom_jitter(
  aes(shape = carbon.tech, color = carbon.tech), #I cut out the "shape = Evolution, " part of the aes so that all shapes would be the same shape
  position = position_jitterdodge(jitter.width = 1.5, dodge.width = 0.7),
  size = 5.5, stroke = 2) +
  scale_shape_manual(values = c(0,15,0,15)) +#12 is a square with a vertical cross inside it
  #scale_color_manual(values = c("black","black","black","blue","black","blue")) +
  stat_summary(
    aes(color = carbon.tech),
    fun.data = "mean_se", fun.args = list(mult = (1)), #mean_sdl add +/- standard deviation; mult=1 means that it is SD*1 that is drawn.  Mean_se draws the standard error of the mean
    geom = "pointrange", size = 3, stroke=2, shape=16,
    position = position_dodge(1),
  ) +
  scale_color_manual(values = mycols_breakout) +
  scale_y_continuous(limits = c(-0.04,1.7),breaks=c(0,.5,1,1.5), expand = c(0,0)) +
  annotate("text",x=0.5,y=1.64,label="b",size=12,color="black")+
  scale_x_discrete(labels = c("G-F5"="1:5","G:F 1:5"="1:5","G-F24"="1:24","G:F 1:24"="1:24"))+
  labs(x="\nG:F ratio",y="Biomass (OD600)\n") +
  annotate("text",x=0.75,y=1.25,label="A",size=12,color="black")+
  annotate("text",x=1.75,y=0.95,label="B",size=12,color="black")+
  annotate("text",x=2.75,y=0.95,label="B",size=12,color="black")+
  annotate("text",x=3.75,y=0.4,label="C",size=12,color="black")+
  #geom_errorbar(data=fig2.7breakout, mapping = aes(x=carbon.tech,ymin=anc.value,ymax=anc.value),color=fig2.7colors,lwd=2.2,linetype=117)+
  annotation_custom(grob = breakoutlegend, xmin=3.4, xmax=4.4, ymin=1.3, ymax=1.55)+
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.background = element_blank(), axis.line = element_line(colour = "black")) +
  theme(legend.key=element_blank(),axis.text.x=element_text(size=34,margin = margin(t = 20, r = 0, b = 0, l = 0)),axis.text.y=element_text(size=34,margin = margin(t = 0, r = 20, b = 0, l = 0)),axis.title=element_text(size=36),legend.text=element_text(size=22),legend.title = element_text(size=34), axis.ticks.y = element_line(color = "black", size = 3), axis.ticks.x = element_line(color = "black", size = 3), axis.ticks.length.x=unit(0.7, "cm"),axis.ticks.length.y=unit(0.7, "cm"), legend.position = "none", panel.border = element_rect(color = "black", fill = NA, size = 3.5), axis.line = element_line(colour = "black"))
fig2.5bpanel

grid.arrange(fig2.5apanel,fig2.5bpanel,nrow=2)

######Fig. B.7
#This is the ancestor on sucrose vs. 1:1
B.7_breakout<-filter(mybreakout,carbon.tech == "G-F" | carbon.tech == "G:F 1:1")
#
B.7_plot <- ggplot(B.7_breakout, aes(x=carbon.tech, y=OD.600))
B.7_plot + geom_jitter(
  aes(shape = carbon.tech, color = carbon.tech), #I cut out the "shape = Evolution, " part of the aes so that all shapes would be the same shape
  position = position_jitterdodge(jitter.width = 1.5, dodge.width = 0.7),
  size = 5.5, stroke = 2) +
  scale_shape_manual(values = c(0,15)) +#12 is a square with a vertical cross inside it
  #scale_color_manual(values = c("black","black","black","blue","black","blue")) +
  stat_summary(
    aes(color = carbon.tech),
    fun.data = "mean_se", fun.args = list(mult = (1)), #mean_sdl add +/- standard deviation; mult=1 means that it is SD*1 that is drawn.  Mean_se draws the standard error of the mean
    geom = "pointrange", size = 3, stroke=2, shape=16,
    position = position_dodge(1),
  ) +
  scale_color_manual(values = mycols_breakout) +
  scale_y_continuous(limits = c(.46,1.6),breaks=c(.5,1,1.5), expand = c(0,0)) +
  scale_x_discrete(labels = c("G-F"="Sucrose","G:F 1:1"="Monomers"))+
  labs(x="",y="Biomass (OD600)\n") +
  annotate("text",x=0.68,y=1.5,label="A",size=12,color="black")+
  annotate("text",x=1.7,y=1.35,label="B",size=12,color="black")+
  annotation_custom(grob = breakoutlegend, xmin=2., xmax=2.5, ymin=1.45, ymax=1.55)+
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.background = element_blank(), axis.line = element_line(colour = "black")) +
    theme(legend.key=element_blank(),axis.text.x=element_text(size=34,margin = margin(t = 20, r = 0, b = 0, l = 0)),axis.text.y=element_text(size=34,margin = margin(t = 0, r = 20, b = 0, l = 0)),axis.title=element_text(size=36),legend.text=element_text(size=22),legend.title = element_text(size=34), axis.ticks.y = element_line(color = "black", size = 3), axis.ticks.x = element_line(color = "black", size = 3), axis.ticks.length.x=unit(0.7, "cm"),axis.ticks.length.y=unit(0.7, "cm"), legend.position = "none", panel.border = element_rect(color = "black", fill = NA, size = 3.5), axis.line = element_line(colour = "black"))



#####Fig. 2.6
fig2.6breakout<-filter(mybreakoutF,carbon.tech == "G" | carbon.tech == "F")
fig2.6colors<-c("darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey")
#F plot
fig2.6plot <- ggplot(fig2.6breakout, aes(x=carbon.tech, y=OD.600))
fig2.6plot + geom_jitter(
  aes(shape = carbon.tech, color = carbon.tech), #I cut out the "shape = Evolution, " part of the aes so that all shapes would be the same shape
  position = position_jitterdodge(jitter.width = 1.5, dodge.width = 0.7),
  size = 5.5, stroke = 2) +
  scale_shape_manual(values = c(0,0)) +#12 is a square with a vertical cross inside it
  #scale_color_manual(values = c("black","black","black","blue","black","blue")) +
  stat_summary(
    aes(color = carbon.tech),
    fun.data = "mean_se", fun.args = list(mult = (1)), #mean_sdl add +/- standard deviation; mult=1 means that it is SD*1 that is drawn.  Mean_se draws the standard error of the mean
    geom = "pointrange", size = 3, stroke=2, shape=16,
    position = position_dodge(1),
  ) +
  scale_color_manual(values = mycols_breakout) +
  scale_y_continuous(limits = c(-0.04,1.85),breaks=c(0,.5,1,1.5), expand = c(0,0)) +
  scale_x_discrete(labels = c("G"="Glucose","F"="Fructose"))+
  labs(x="",y="Biomass (OD600)\n") +
  annotate("text",x=0.68,y=1.5,label="",size=12,color="black")+
  annotate("text",x=1.7,y=0.55,label="",size=12,color="black")+
  geom_errorbar(data=Fig2.6breakout, mapping = aes(x=carbon.tech,ymin=anc.value,ymax=anc.value),color=fig2.6colors,lwd=2.2,linetype=117)+
  #annotation_custom(grob = breakoutlegend, xmin=5.4, xmax=6.4, ymin=1.4, ymax=1.55)+
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.background = element_blank(), axis.line = element_line(colour = "black")) +
    theme(legend.key=element_blank(),axis.text.x=element_text(size=34,margin = margin(t = 20, r = 0, b = 0, l = 0)),axis.text.y=element_text(size=34,margin = margin(t = 0, r = 20, b = 0, l = 0)),axis.title=element_text(size=36),legend.text=element_text(size=22),legend.title = element_text(size=34), axis.ticks.y = element_line(color = "black", size = 3), axis.ticks.x = element_line(color = "black", size = 3), axis.ticks.length.x=unit(0.7, "cm"),axis.ticks.length.y=unit(0.7, "cm"), legend.position = "none", panel.border = element_rect(color = "black", fill = NA, size = 3.5), axis.line = element_line(colour = "black"))

#####Fig. B.8
#This is F evolved bacteria on DP5, DP24, and the corresponding deconstructed monomers.
figb.8breakout<-filter(mybreakoutF,carbon.tech == "G-F5" | carbon.tech == "G:F 1:5" | carbon.tech == "G-F24" | carbon.tech == "G:F 1:24")
figb.8colors<-c("darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey")
#F plot
figb.8plot <- ggplot(figb.8breakout, aes(x=carbon.tech, y=OD.600))
figb.8plot + geom_jitter(
  aes(shape = carbon.tech, color = carbon.tech), #I cut out the "shape = Evolution, " part of the aes so that all shapes would be the same shape
  position = position_jitterdodge(jitter.width = 1.5, dodge.width = 0.7),
  size = 5.5, stroke = 2) +
  scale_shape_manual(values = c(0,15,0,15)) +#12 is a square with a vertical cross inside it
  #scale_color_manual(values = c("black","black","black","blue","black","blue")) +
  stat_summary(
    aes(color = carbon.tech),
    fun.data = "mean_se", fun.args = list(mult = (1)), #mean_sdl add +/- standard deviation; mult=1 means that it is SD*1 that is drawn.  Mean_se draws the standard error of the mean
    geom = "pointrange", size = 3, stroke=2, shape=16,
    position = position_dodge(1),
  ) +
  scale_color_manual(values = mycols_breakout) +
  scale_y_continuous(limits = c(-0.04,1.66),breaks=c(0,.5,1,1.5), expand = c(0,0)) +
  scale_x_discrete(labels = c("G-F5"="1:5","G:F 1:5"="1:5","G-F24"="1:24","G:F 1:24"="1:24"))+
  labs(x="\nG:F ratio",y="Biomass (OD600)\n") +
  annotate("text",x=0.68,y=1.5,label="A",size=12,color="black")+
  annotate("text",x=1.7,y=1.04,label="B",size=12,color="black")+
  annotate("text",x=2.7,y=1.5,label="A",size=12,color="black")+
  annotate("text",x=3.67,y=0.55,label="C",size=12,color="black")+
  geom_errorbar(data=figb.8breakout, mapping = aes(x=carbon.tech,ymin=anc.value,ymax=anc.value),color=figb.8colors,lwd=2.2,linetype=117)+
  annotation_custom(grob = breakoutlegend, xmin=3.4, xmax=4.4, ymin=1.4, ymax=1.55)+
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.background = element_blank(), axis.line = element_line(colour = "black")) +
    theme(legend.key=element_blank(),axis.text.x=element_text(size=34,margin = margin(t = 20, r = 0, b = 0, l = 0)),axis.text.y=element_text(size=34,margin = margin(t = 0, r = 20, b = 0, l = 0)),axis.title=element_text(size=36),legend.text=element_text(size=22),legend.title = element_text(size=34), axis.ticks.y = element_line(color = "black", size = 3), axis.ticks.x = element_line(color = "black", size = 3), axis.ticks.length.x=unit(0.7, "cm"),axis.ticks.length.y=unit(0.7, "cm"), legend.position = "none", panel.border = element_rect(color = "black", fill = NA, size = 3.5), axis.line = element_line(colour = "black"))



#####Fig. 2.7
#This is DP5 evolved popns on DP5, DP24, and corresponding monomers
fig2.7breakout<-filter(mybreakoutP,carbon.tech == "G-F5" | carbon.tech == "G:F 1:5" | carbon.tech == "G-F24" | carbon.tech == "G:F 1:24")
fig2.7colors<-c("darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey")
#F plot
fig2.7plot <- ggplot(fig2.7breakout, aes(x=carbon.tech, y=OD.600))
fig2.7plot + geom_jitter(
  aes(shape = carbon.tech, color = carbon.tech), #I cut out the "shape = Evolution, " part of the aes so that all shapes would be the same shape
  position = position_jitterdodge(jitter.width = 1.5, dodge.width = 0.7),
  size = 5.5, stroke = 2) +
  scale_shape_manual(values = c(0,15,0,15)) +#12 is a square with a vertical cross inside it
  #scale_color_manual(values = c("black","black","black","blue","black","blue")) +
  stat_summary(
    aes(color = carbon.tech),
    fun.data = "mean_se", fun.args = list(mult = (1)), #mean_sdl add +/- standard deviation; mult=1 means that it is SD*1 that is drawn.  Mean_se draws the standard error of the mean
    geom = "pointrange", size = 3, stroke=2, shape=16,
    position = position_dodge(1),
  ) +
  scale_color_manual(values = mycols_breakout) +
  scale_y_continuous(limits = c(-0.04,1.66),breaks=c(0,.5,1,1.5), expand = c(0,0)) +
  scale_x_discrete(labels = c("G-F5"="1:5","G:F 1:5"="1:5","G-F24"="1:24","G:F 1:24"="1:24"))+
  labs(x="\nG:F ratio",y="Biomass (OD600)\n") +
  annotate("text",x=0.68,y=1.25,label="A",size=12,color="black")+
  annotate("text",x=1.68,y=1.25,label="A",size=12,color="black")+
  annotate("text",x=2.68,y=1.25,label="A",size=12,color="black")+
  annotate("text",x=3.67,y=0.5,label="B",size=12,color="black")+
  geom_errorbar(data=fig2.7breakout, mapping = aes(x=carbon.tech,ymin=anc.value,ymax=anc.value),color=fig2.7colors,lwd=2.2,linetype=117)+
  annotation_custom(grob = breakoutlegend, xmin=3.4, xmax=4.4, ymin=1.35, ymax=1.6)+
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.background = element_blank(), axis.line = element_line(colour = "black")) +
    theme(legend.key=element_blank(),axis.text.x=element_text(size=34,margin = margin(t = 20, r = 0, b = 0, l = 0)),axis.text.y=element_text(size=34,margin = margin(t = 0, r = 20, b = 0, l = 0)),axis.title=element_text(size=36),legend.text=element_text(size=22),legend.title = element_text(size=34), axis.ticks.y = element_line(color = "black", size = 3), axis.ticks.x = element_line(color = "black", size = 3), axis.ticks.length.x=unit(0.7, "cm"),axis.ticks.length.y=unit(0.7, "cm"), legend.position = "none", panel.border = element_rect(color = "black", fill = NA, size = 3.5), axis.line = element_line(colour = "black"))


######Fig. B.9
#This is the DP5 on sucrose vs. 1:1
B.9breakout<-filter(mybreakoutP,carbon.tech == "G-F" | carbon.tech == "G:F 1:1")
figb.9colors<-c("darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey")
#
B.9_plot <- ggplot(B.9breakout, aes(x=carbon.tech, y=OD.600))
B.9_plot + geom_jitter(
  aes(shape = carbon.tech, color = carbon.tech), #I cut out the "shape = Evolution, " part of the aes so that all shapes would be the same shape
  position = position_jitterdodge(jitter.width = 1.5, dodge.width = 0.7),
  size = 5.5, stroke = 2) +
  scale_shape_manual(values = c(0,15)) +#12 is a square with a vertical cross inside it
  #scale_color_manual(values = c("black","black","black","blue","black","blue")) +
  stat_summary(
    aes(color = carbon.tech),
    fun.data = "mean_se", fun.args = list(mult = (1)), #mean_sdl add +/- standard deviation; mult=1 means that it is SD*1 that is drawn.  Mean_se draws the standard error of the mean
    geom = "pointrange", size = 3, stroke=2, shape=16,
    position = position_dodge(1),
  ) +
  scale_color_manual(values = mycols_breakout) +
  scale_y_continuous(limits = c(.46,1.7),breaks=c(.5,1,1.5), expand = c(0,0)) +
  scale_x_discrete(labels = c("G-F"="Sucrose","G:F 1:1"="Monomers"))+
  labs(x="",y="Biomass (OD600)\n") +
  annotate("text",x=0.68,y=1.5,label="",size=12,color="black")+
  annotate("text",x=1.7,y=1.35,label="",size=12,color="black")+
  annotation_custom(grob = breakoutlegend, xmin=2.0, xmax=2.6, ymin=1.52, ymax=1.65)+
  geom_errorbar(data=B.9breakout, mapping = aes(x=carbon.tech,ymin=anc.value,ymax=anc.value),color=figb.9colors,lwd=2.2,linetype=117)+
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.background = element_blank(), axis.line = element_line(colour = "black")) +
    theme(legend.key=element_blank(),axis.text.x=element_text(size=34,margin = margin(t = 20, r = 0, b = 0, l = 0)),axis.text.y=element_text(size=34,margin = margin(t = 0, r = 20, b = 0, l = 0)),axis.title=element_text(size=36),legend.text=element_text(size=22),legend.title = element_text(size=34), axis.ticks.y = element_line(color = "black", size = 3), axis.ticks.x = element_line(color = "black", size = 3), axis.ticks.length.x=unit(0.7, "cm"),axis.ticks.length.y=unit(0.7, "cm"), legend.position = "none", panel.border = element_rect(color = "black", fill = NA, size = 3.5), axis.line = element_line(colour = "black"))


######Fig. B.10
#This is the DP24-evolved on sucrose vs. 1:1
B.10breakout<-filter(mybreakoutX,carbon.tech == "G-F" | carbon.tech == "G:F 1:1")
figb.10colors<-c("darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey")
#
B.10_plot <- ggplot(B.10breakout, aes(x=carbon.tech, y=OD.600))
B.10_plot + geom_jitter(
  aes(shape = carbon.tech, color = carbon.tech), #I cut out the "shape = Evolution, " part of the aes so that all shapes would be the same shape
  position = position_jitterdodge(jitter.width = 1.5, dodge.width = 0.7),
  size = 5.5, stroke = 2) +
  scale_shape_manual(values = c(0,15)) +#12 is a square with a vertical cross inside it
  #scale_color_manual(values = c("black","black","black","blue","black","blue")) +
  stat_summary(
    aes(color = carbon.tech),
    fun.data = "mean_se", fun.args = list(mult = (1)), #mean_sdl add +/- standard deviation; mult=1 means that it is SD*1 that is drawn.  Mean_se draws the standard error of the mean
    geom = "pointrange", size = 3, stroke=2, shape=16,
    position = position_dodge(1),
  ) +
  scale_color_manual(values = mycols_breakout) +
  scale_y_continuous(limits = c(.46,1.7),breaks=c(.5,1,1.5), expand = c(0,0)) +
  scale_x_discrete(labels = c("G-F"="Sucrose","G:F 1:1"="Monomers"))+
  labs(x="",y="Biomass (OD600)\n") +
  annotate("text",x=0.68,y=1.5,label="",size=12,color="black")+
  annotate("text",x=1.7,y=1.35,label="",size=12,color="black")+
  annotation_custom(grob = breakoutlegend, xmin=2, xmax=2.6, ymin=1.52, ymax=1.65)+
  geom_errorbar(data=B.10breakout, mapping = aes(x=carbon.tech,ymin=anc.value,ymax=anc.value),color=figb.10colors,lwd=2.2,linetype=117)+
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.background = element_blank(), axis.line = element_line(colour = "black")) +
    theme(legend.key=element_blank(),axis.text.x=element_text(size=34,margin = margin(t = 20, r = 0, b = 0, l = 0)),axis.text.y=element_text(size=34,margin = margin(t = 0, r = 20, b = 0, l = 0)),axis.title=element_text(size=36),legend.text=element_text(size=22),legend.title = element_text(size=34), axis.ticks.y = element_line(color = "black", size = 3), axis.ticks.x = element_line(color = "black", size = 3), axis.ticks.length.x=unit(0.7, "cm"),axis.ticks.length.y=unit(0.7, "cm"), legend.position = "none", panel.border = element_rect(color = "black", fill = NA, size = 3.5), axis.line = element_line(colour = "black"))




#####Fig. 2.8
#This is DP24 evolved popns on DP5, DP24, and corresponding monomers
fig2.8breakout<-filter(mybreakoutX,carbon.tech == "G-F5" | carbon.tech == "G:F 1:5" | carbon.tech == "G-F24" | carbon.tech == "G:F 1:24")
fig2.8colors<-c("darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey")
#F plot
fig2.8plot <- ggplot(fig2.8breakout, aes(x=carbon.tech, y=OD.600))
fig2.8plot + geom_jitter(
  aes(shape = carbon.tech, color = carbon.tech), #I cut out the "shape = Evolution, " part of the aes so that all shapes would be the same shape
  position = position_jitterdodge(jitter.width = 1.5, dodge.width = 0.7),
  size = 5.5, stroke = 2) +
  scale_shape_manual(values = c(0,15,0,15)) +#12 is a square with a vertical cross inside it
  #scale_color_manual(values = c("black","black","black","blue","black","blue")) +
  stat_summary(
    aes(color = carbon.tech),
    fun.data = "mean_se", fun.args = list(mult = (1)), #mean_sdl add +/- standard deviation; mult=1 means that it is SD*1 that is drawn.  Mean_se draws the standard error of the mean
    geom = "pointrange", size = 3, stroke=2, shape=16,
    position = position_dodge(1),
  ) +
  scale_color_manual(values = mycols_breakout) +
  scale_y_continuous(limits = c(-0.04,1.66),breaks=c(0,.5,1,1.5), expand = c(0,0)) +
  scale_x_discrete(labels = c("G-F5"="1:5","G:F 1:5"="1:5","G-F24"="1:24","G:F 1:24"="1:24"))+
  labs(x="\nG:F ratio",y="Biomass (OD600)\n") +
  annotate("text",x=0.68,y=1.25,label="A",size=12,color="black")+
  annotate("text",x=1.68,y=1.25,label="A",size=12,color="black")+
  annotate("text",x=2.68,y=1.25,label="A",size=12,color="black")+
  annotate("text",x=3.67,y=0.5,label="B",size=12,color="black")+
  geom_errorbar(data=fig2.8breakout, mapping = aes(x=carbon.tech,ymin=anc.value,ymax=anc.value),color=fig2.8colors,lwd=2.2,linetype=117)+
  annotation_custom(grob = breakoutlegend, xmin=3.4, xmax=4.4, ymin=1.35, ymax=1.6)+
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.background = element_blank(), axis.line = element_line(colour = "black")) +
    theme(legend.key=element_blank(),axis.text.x=element_text(size=34,margin = margin(t = 20, r = 0, b = 0, l = 0)),axis.text.y=element_text(size=34,margin = margin(t = 0, r = 20, b = 0, l = 0)),axis.title=element_text(size=36),legend.text=element_text(size=22),legend.title = element_text(size=34), axis.ticks.y = element_line(color = "black", size = 3), axis.ticks.x = element_line(color = "black", size = 3), axis.ticks.length.x=unit(0.7, "cm"),axis.ticks.length.y=unit(0.7, "cm"), legend.position = "none", panel.border = element_rect(color = "black", fill = NA, size = 3.5), axis.line = element_line(colour = "black"))


#####Fig. B.11
#This is DP5-evolved. Comparing growth on glu vs. fru.
figb.11breakout<-filter(mybreakoutP,carbon.tech == "G" | carbon.tech == "F")
figb.11colors<-c("darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey")
#F plot
figb.11plot <- ggplot(figb.11breakout, aes(x=carbon.tech, y=OD.600))
figb.11plot + geom_jitter(
  aes(shape = carbon.tech, color = carbon.tech), #I cut out the "shape = Evolution, " part of the aes so that all shapes would be the same shape
  position = position_jitterdodge(jitter.width = 1.5, dodge.width = 0.7),
  size = 5.5, stroke = 2) +
  scale_shape_manual(values = c(0,0)) +#12 is a square with a vertical cross inside it
  #scale_color_manual(values = c("black","black","black","blue","black","blue")) +
  stat_summary(
    aes(color = carbon.tech),
    fun.data = "mean_se", fun.args = list(mult = (1)), #mean_sdl add +/- standard deviation; mult=1 means that it is SD*1 that is drawn.  Mean_se draws the standard error of the mean
    geom = "pointrange", size = 3, stroke=2, shape=16,
    position = position_dodge(1),
  ) +
  scale_color_manual(values = mycols_breakout) +
  scale_y_continuous(limits = c(-0.04,1.85),breaks=c(0,.5,1,1.5), expand = c(0,0)) +
  scale_x_discrete(labels = c("G"="Glucose","F"="Fructose"))+
  labs(x="",y="Biomass (OD600)\n") +
  annotate("text",x=0.7,y=1.55,label="A",size=12,color="black")+
  annotate("text",x=1.7,y=1.15,label="B",size=12,color="black")+
  geom_errorbar(data=figb.11breakout, mapping = aes(x=carbon.tech,ymin=anc.value,ymax=anc.value),color=figb.11colors,lwd=2.2,linetype=117)+
  #annotation_custom(grob = breakoutlegend, xmin=5.4, xmax=6.4, ymin=1.4, ymax=1.55)+
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.background = element_blank(), axis.line = element_line(colour = "black")) +
    theme(legend.key=element_blank(),axis.text.x=element_text(size=34,margin = margin(t = 20, r = 0, b = 0, l = 0)),axis.text.y=element_text(size=34,margin = margin(t = 0, r = 20, b = 0, l = 0)),axis.title=element_text(size=36),legend.text=element_text(size=22),legend.title = element_text(size=34), axis.ticks.y = element_line(color = "black", size = 3), axis.ticks.x = element_line(color = "black", size = 3), axis.ticks.length.x=unit(0.7, "cm"),axis.ticks.length.y=unit(0.7, "cm"), legend.position = "none", panel.border = element_rect(color = "black", fill = NA, size = 3.5), axis.line = element_line(colour = "black"))


#####Fig. B.12
#This is DP24-evolved. Comparing growth on glu vs. fru.
figb.12breakout<-filter(mybreakoutX,carbon.tech == "G" | carbon.tech == "F")
figb.12colors<-c("darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey")
#F plot
figb.12plot <- ggplot(figb.12breakout, aes(x=carbon.tech, y=OD.600))
figb.12plot + geom_jitter(
  aes(shape = carbon.tech, color = carbon.tech), #I cut out the "shape = Evolution, " part of the aes so that all shapes would be the same shape
  position = position_jitterdodge(jitter.width = 1.5, dodge.width = 0.7),
  size = 5.5, stroke = 2) +
  scale_shape_manual(values = c(0,0)) +#12 is a square with a vertical cross inside it
  #scale_color_manual(values = c("black","black","black","blue","black","blue")) +
  stat_summary(
    aes(color = carbon.tech),
    fun.data = "mean_se", fun.args = list(mult = (1)), #mean_sdl add +/- standard deviation; mult=1 means that it is SD*1 that is drawn.  Mean_se draws the standard error of the mean
    geom = "pointrange", size = 3, stroke=2, shape=16,
    position = position_dodge(1),
  ) +
  scale_color_manual(values = mycols_breakout) +
  scale_y_continuous(limits = c(-0.04,1.85),breaks=c(0,.5,1,1.5), expand = c(0,0)) +
  scale_x_discrete(labels = c("G"="Glucose","F"="Fructose"))+
  labs(x="",y="Biomass (OD600)\n") +
  annotate("text",x=0.7,y=1.55,label="A",size=12,color="black")+
  annotate("text",x=1.7,y=1.25,label="B",size=12,color="black")+
  geom_errorbar(data=figb.12breakout, mapping = aes(x=carbon.tech,ymin=anc.value,ymax=anc.value),color=figb.12colors,lwd=2.2,linetype=117)+
  #annotation_custom(grob = breakoutlegend, xmin=5.4, xmax=6.4, ymin=1.4, ymax=1.55)+
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.background = element_blank(), axis.line = element_line(colour = "black")) +
    theme(legend.key=element_blank(),axis.text.x=element_text(size=34,margin = margin(t = 20, r = 0, b = 0, l = 0)),axis.text.y=element_text(size=34,margin = margin(t = 0, r = 20, b = 0, l = 0)),axis.title=element_text(size=36),legend.text=element_text(size=22),legend.title = element_text(size=34), axis.ticks.y = element_line(color = "black", size = 3), axis.ticks.x = element_line(color = "black", size = 3), axis.ticks.length.x=unit(0.7, "cm"),axis.ticks.length.y=unit(0.7, "cm"), legend.position = "none", panel.border = element_rect(color = "black", fill = NA, size = 3.5), axis.line = element_line(colour = "black"))
```

# ############################################### OD SECTION


# Make some unused plots for OD xpts

# Plot the evolved data as Absolute Increase Vs. Ancestor
```{r}
#fig
odtube151_abs.change <- ggplot(mydf151, aes(x=carbon2, y=abs.change.vs.anc))
odtube151_abs.change +#geom_errorbar(aes(ymin=anc.OD,ymax=anc.OD),color=anc.colors,lwd = 2.25,linetype=117) +
  geom_jitter(
    aes(shape = carbon2, color = carbon2), #I cut out the "shape = Evolution, " part of the aes so that all shapes would be the same shape
    position = position_jitterdodge(jitter.width = 1.5, dodge.width = 0.7),
    size = 5.5, stroke = 2) +
  scale_shape_manual(values = c(0,0,0)) +#12 is a square with a vertical cross inside it
  stat_summary(
    aes(color = carbon2),
    fun.data = "mean_se", fun.args = list(mult = (1)), #mean_sdl add +/- standard deviation; mult=1 means that it is SD*1 that is drawn.  Mean_se draws the standard error of the mean
    geom = "pointrange", size = 3, stroke=2, shape=16,
    position = position_dodge(1),
  ) +
  scale_color_manual(values = mycols) +
  scale_y_continuous(limits = c(-0.04,1.25),breaks=c(0,.4,.8,1.2), expand = c(0,0)) +
  labs(x="\nDiet",y="Evolved increase in OD600\n") +
  annotate("text",x=.6,y=1.1,label="A",size=12,color="black")+
  annotate("text",x=1.6,y=0.65,label="B",size=12,color="black")+
  annotate("text",x=2.6,y=0.35,label="C",size=12,color="black")+
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.background = element_blank(), axis.line = element_line(colour = "black")) +
    theme(legend.key=element_blank(),axis.text.x=element_text(size=34,margin = margin(t = 20, r = 0, b = 0, l = 0)),axis.text.y=element_text(size=34,margin = margin(t = 0, r = 20, b = 0, l = 0)),axis.title=element_text(size=36),legend.text=element_text(size=22),legend.title = element_text(size=34), axis.ticks.y = element_line(color = "black", size = 3), axis.ticks.x = element_line(color = "black", size = 3), axis.ticks.length.x=unit(0.7, "cm"),axis.ticks.length.y=unit(0.7, "cm"), legend.position = "none", panel.border = element_rect(color = "black", fill = NA, size = 3.5), axis.line = element_line(colour = "black"))
```

# Plot the evolved data as Percent Increase Vs. Ancestor
```{r}

odtube151_pct.change <- ggplot(mydf151, aes(x=carbon2, y=percent.increase.vs.anc))
odtube151_pct.change +#geom_errorbar(aes(ymin=anc.OD,ymax=anc.OD),color=anc.colors,lwd = 2.25,linetype=117) +
  geom_jitter(
    aes(shape = carbon2, color = carbon2), #I cut out the "shape = Evolution, " part of the aes so that all shapes would be the same shape
    position = position_jitterdodge(jitter.width = 1.5, dodge.width = 0.7),
    size = 5.5, stroke = 2) +
  scale_shape_manual(values = c(0,0,0)) +#12 is a square with a vertical cross inside it
  stat_summary(
    aes(color = carbon2),
    fun.data = "mean_se", fun.args = list(mult = (1)), #mean_sdl add +/- standard deviation; mult=1 means that it is SD*1 that is drawn.  Mean_se draws the standard error of the mean
    geom = "pointrange", size = 3, stroke=2, shape=16,
    position = position_dodge(1),
  ) +
  scale_color_manual(values = mycols) +
  scale_y_continuous(limits = c(-4,416),breaks=c(0,100,200,300,400), expand = c(0,0)) +
  labs(x="\nDiet",y="Evolved % increase in OD 600\n") +
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.background = element_blank(), axis.line = element_line(colour = "black")) +
    theme(legend.key=element_blank(),axis.text.x=element_text(size=34,margin = margin(t = 20, r = 0, b = 0, l = 0)),axis.text.y=element_text(size=34,margin = margin(t = 0, r = 20, b = 0, l = 0)),axis.title=element_text(size=36),legend.text=element_text(size=22),legend.title = element_text(size=34), axis.ticks.y = element_line(color = "black", size = 3), axis.ticks.x = element_line(color = "black", size = 3), axis.ticks.length.x=unit(0.7, "cm"),axis.ticks.length.y=unit(0.7, "cm"), legend.position = "none", panel.border = element_rect(color = "black", fill = NA, size = 3.5), axis.line = element_line(colour = "black"))

```

# Make the same plot as Fig. S2 but with an axis that will also fit the evolved bacteria data
```{r}
odtube0_sameaxis <- ggplot(mydf0, aes(x=carbon2, y=OD.600))
odtube0_sameaxis + geom_jitter(
  aes(shape = carbon2, color = carbon2), #I cut out the "shape = Evolution, " part of the aes so that all shapes would be the same shape
  position = position_jitterdodge(jitter.width = 1.5, dodge.width = 0.7),
  size = 5.5, stroke = 2) +
  scale_shape_manual(values = c(0,0,0)) +#12 is a square with a vertical cross inside it
  stat_summary(
    aes(color = carbon2),
    fun.data = "mean_se", fun.args = list(mult = (1)), #mean_sdl add +/- standard deviation; mult=1 means that it is SD*1 that is drawn.  Mean_se draws the standard error of the mean
    geom = "pointrange", size = 3, stroke=2, shape=16,
    position = position_dodge(1),
  ) +
  scale_color_manual(values = mycols) +
  scale_y_continuous(limits = c(-0.04,1.6),breaks=c(0,.5,1,1.5), expand = c(0,0)) +
  labs(x="\nCarbon source",y="OD 600\n") +
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.background = element_blank(), axis.line = element_line(colour = "black")) +
    theme(legend.key=element_blank(),axis.text.x=element_text(size=34,margin = margin(t = 20, r = 0, b = 0, l = 0)),axis.text.y=element_text(size=34,margin = margin(t = 0, r = 20, b = 0, l = 0)),axis.title=element_text(size=36),legend.text=element_text(size=22),legend.title = element_text(size=34), axis.ticks.y = element_line(color = "black", size = 3), axis.ticks.x = element_line(color = "black", size = 3), axis.ticks.length.x=unit(0.7, "cm"),axis.ticks.length.y=unit(0.7, "cm"), legend.position = "none", panel.border = element_rect(color = "black", fill = NA, size = 3.5), axis.line = element_line(colour = "black"))
```
# Unused statistical tests for OD xpts
```{r}
#For each carbon source, I could do two-sample t-test to ask whether growth increased after evolution.
#This is misleading, though, because there are two different levels of replication.
#We should really be doing one-sample t-tests and taking the ancestral value as fixed.

################################################################################
#Below, do the two-sample t-tests

#Did growth on fructose increase during 866 generations of natural selection?
var.test(x=c(filter(mydf0, carbon=="Monomer")$OD.600),y=c(filter(mydf151, carbon == "Monomer")$OD.600),ratio=1,alternative = "t")
#P = .3316. Homoscedastic.
t.test(x=c(filter(mydf0, carbon=="Monomer")$OD.600),y=c(filter(mydf151, carbon == "Monomer")$OD.600),mu=0,alternative = "l",paired=F,var.equal=T)
#p = 4.543EE-16 < 0.0001

#Did growth on P95 inulin (DP = 2-8) increase during 866 generations of natural selection?
var.test(x=c(filter(mydf0, carbon=="Low-DP")$OD.600),y=c(filter(mydf151, carbon == "Low-DP")$OD.600),ratio=1,alternative = "t")
#P = .1358. Homoscedastic.
t.test(x=c(filter(mydf0, carbon=="Low-DP")$OD.600),y=c(filter(mydf151, carbon == "Low-DP")$OD.600),mu=0,alternative = "l",paired=F,var.equal=T)
#p = 5.010EE-10 < 0.0001

#Did growth on TEX inulin (DP > 23) increase during 866 generations of natural selection?
var.test(x=c(filter(mydf0, carbon=="High-DP")$OD.600),y=c(filter(mydf151, carbon == "High-DP")$OD.600),ratio=1,alternative = "t")
#P = .04689. Heteroscedastic.
t.test(x=c(filter(mydf0, carbon=="High-DP")$OD.600),y=c(filter(mydf151, carbon == "High-DP")$OD.600),mu=0,alternative = "l",paired=F,var.equal=F)
#p = 0.0004431 < 0.001

mypvec151<-c(t.test(x=c(filter(mydf0, carbon=="Monomer")$OD.600),y=c(filter(mydf151, carbon == "Monomer")$OD.600),mu=0,alternative = "l",paired=F,var.equal=T)$p.value, t.test(x=c(filter(mydf0, carbon=="Low-DP")$OD.600),y=c(filter(mydf151, carbon == "Low-DP")$OD.600),mu=0,alternative = "l",paired=F,var.equal=T)$p.value, t.test(x=c(filter(mydf0, carbon=="High-DP")$OD.600),y=c(filter(mydf151, carbon == "High-DP")$OD.600),mu=0,alternative = "l",paired=F,var.equal=F)$p.value)

mypvec151.adjust<-p.adjust(p=mypvec151, method = "BH")#cite BH&Y 2009
mypvec151.adjust
```

